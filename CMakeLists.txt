PROJECT(cairocks)

CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

SET(CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}")
SET(CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}/etc/")
SET(CMAKE_C_FLAGS "-W -Wall -Wno-unused-parameter -Werror -std=c90 -ansi -pedantic")
SET(CMAKE_CXX_FLAGS "-W -Wall -Wno-unused-parameter -Werror -std=c++11")

FIND_PACKAGE(Cairo REQUIRED)
FIND_PACKAGE(JPEG REQUIRED)
FIND_PACKAGE(GIF REQUIRED)

SET(CAIROCKS_SRC_FILES
	"src/distance-field.c"
	"src/emboss.c"
	"src/gaussian-blur.c"
	"src/gif-surface.c"
	"src/invert.c"
	"src/map-path-onto.c"
	"src/rounded.c"
	"src/surface-from-jpeg.c"
	"src/named-path.cpp"
)

SET(CAIROCKS_HEADER_FILE "src/cairocks.h")

INCLUDE_DIRECTORIES(
	src
	${CAIRO_INCLUDE_DIRS}
	${JPEG_INCLUDE_DIR}
	${GIF_INCLUDE_DIR}
)

LINK_DIRECTORIES(
	${CAIRO_LIBRARY_DIRS}
)

SOURCE_GROUP("Header Files" FILES ${CAIROCKS_HEADER_FILE})
SOURCE_GROUP("Source Files" FILES ${CAIROCKS_SRC_FILES})

ADD_LIBRARY(cairocks SHARED ${CAIROCKS_HEADER_FILE} ${CAIROCKS_SRC_FILES})

TARGET_LINK_LIBRARIES(cairocks cairo ${JPEG_LIBRARIES} ${GIF_LIBRARIES})

INSTALL(TARGETS cairocks
	ARCHIVE DESTINATION ${CMAKE_INSTALL_PREFIX}/lib
	LIBRARY DESTINATION ${CMAKE_INSTALL_PREFIX}/lib
	RUNTIME DESTINATION ${CMAKE_INSTALL_PREFIX}/bin
)

INSTALL(
	FILES ${CAIROCKS_HEADER_FILE}
	DESTINATION ${CMAKE_INSTALL_PREFIX}/include
)

CONFIGURE_FILE(
	"${CMAKE_CURRENT_SOURCE_DIR}/etc/uninstall.cmake"
	"${CMAKE_CURRENT_BINARY_DIR}/uninstall.cmake"
	IMMEDIATE @ONLY
)

ADD_CUSTOM_TARGET(uninstall
	"${CMAKE_COMMAND}" -P "${CMAKE_CURRENT_BINARY_DIR}/uninstall.cmake"
)

